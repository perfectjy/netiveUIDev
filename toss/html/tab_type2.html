<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta http-equiv="X-UA-compatible" content="IE=edge, chrome=1" />
    <title>make a Tab</title>
    <link rel="stylesheet" type="text/css" href="../asset/css/guide.css">
    <script type="text/javascript" src="../asset/js/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="../asset/js/jquery.easing.min.js"></script>
    <!-- <script type="text/javascript" src="../asset/js/common.js"></script> -->
    <link rel="shortcut icon" href="/practice/jyDev/asset/img/favicon-32x32.png">
</head>
<body>
    <header>
        <h1>Tab</h1>
    </header>
    <div class="wrap">
        
        <div class="ui-tab" data-tab-parent="tab1">
            <div class="ui-tab-btns">
                <button type="button" class="ui-tab-btn">
                    <span>탭메뉴1</span>
                </button>
                <button type="button" class="ui-tab-btn">
                    <span>탭메뉴2</span>
                </button>
                <button type="button" class="ui-tab-btn">
                    <span>탭메뉴3</span>
                </button>
                <button type="button" class="ui-tab-btn">
                    <span>탭메뉴4</span>
                </button>
                <button type="button" class="ui-tab-btn">
                    <span>탭메뉴5</span>
                </button>
            </div>
            <div class="ui-tab-panels" data-tab-panel="tab1">
                <section class="tab-panel">
                    <h2 class="tab-tit">tab1 title</h2>
                    <div class="cont">
                        tab1 contents
                        <div class="ui-tab" data-tab-parent="tab3" style="margin-top:50px;">
                            <div class="ui-tab-btns">
                                <button type="button" class="ui-tab-btn">
                                    <span>탭메뉴1-1</span>
                                </button>
                                <button type="button" class="ui-tab-btn">
                                    <span>탭메뉴1-2</span>
                                </button>
                            </div>
                            <div class="ui-tab-panels" data-tab-panel="tab3">
                                <section class="tab-panel">
                                    <h2 class="tab-tit">tab1-1 title</h2>
                                </section>
                                <section class="tab-panel">
                                    <h2 class="tab-tit">tab1-2 title</h2>
                                </section>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="tab-panel">
                    <h2 class="tab-tit">tab2 title</h2>
                    <div class="cont">
                        tab2 contents
                    </div>
                </section>
                <section class="tab-panel">
                    <h2 class="tab-tit">tab3 title</h2>
                    <div class="cont">
                        tab3 contents
                    </div>
                </section>
                <section class="tab-panel">
                    <h2 class="tab-tit">tab4 title</h2>
                    <div class="cont">
                        tab4 contents
                    </div>
                </section>
                <section class="tab-panel">
                    <h2 class="tab-tit">tab5 title</h2>
                    <div class="cont">
                        tab5 contents
                    </div>
                </section>
            </div>
        </div>

        <div class="ui-tab" data-tab-parent="tab2" style="margin-top:50px;">
            <div class="ui-tab-btns">
                <button type="button" class="ui-tab-btn">
                    <span>탭메뉴6</span>
                </button>
                <button type="button" class="ui-tab-btn">
                    <span>탭메뉴7</span>
                </button>
            </div>
            <div class="ui-tab-panels" data-tab-panel="tab2">
                <section class="tab-panel">
                    <h2 class="tab-tit">tab6 title</h2>
                    <div class="cont">
                        tab6 contents
                    </div>
                </section>
                <section class="tab-panel">
                    <h2 class="tab-tit">tab7 title</h2>
                    <div class="cont">
                        tab7 contents
                    </div>
                </section>
            </div>
        </div>
        
    </div>

    <script>
        ; (function(win, doc) {
            'use strict';

            const global = 'test';
            win[global] = {};
        
            const Global = win[global];
            // 클래스 존재여부 확인 :: contains 
            // 클래스 교체 :: replace('oldClass', 'newClass');
            
            Global.tab = {
                init : function(opt) {
                    const _this = this;
                    _this.id = opt.id;
                    const tabMenuParent = doc.querySelector('[data-tab-parent='+ _this.id +']');
                    const tabContParent = doc.querySelector('[data-tab-panel='+ _this.id +']');
                    const tabMenuBtns = tabMenuParent.querySelector('.ui-tab-btns');
                    const tabMenu = tabMenuBtns.querySelectorAll('.ui-tab-btn');
                    const tabPanel = tabContParent.children;
                    let len = tabMenu.length;

                    for(const menu of tabMenu) {
                        if(!menu.dataset.tab) {
                            menu.addEventListener('click', activeTab);
                        }
                    }

                    function activeTab(){  
                        const tabBtns = this.parentElement;
                        const tabItem = tabBtns.children;
                        let len = tabItem.length;
                        let n_panel = getParentNode(this, tabPanel);
                        let n_item = getParentNode(this, tabItem);
                    
                        for(let i=0; i<len; i++){ 

                            tabItem[i].classList.remove('selected');
                        
                            if(!tabItem[i].classList.contains('selected')) {
                                this.classList.add('selected');
                                tabPanel[i].classList.remove( 'selected'); 

                                if(!tabPanel[i].classList.contains('selected')) {
                                    tabPanel[n_panel].classList.add('selected'); 
                                }
                            }
                        }
                    }

                    // 자기 자신 index값 찾기
                    function getParentNode(el, range) {
                        if(!!range) { 
                            return [].indexOf.call(el.parentNode.children, el);
                        }
                    }
                }
            }

            Global.tab.init({
               id: 'tab1'
            });

            Global.tab.init({
                id: 'tab2'
            });

            Global.tab.init({
                id: 'tab3'
            });

        })(window, document);
    </script>
</body>
</html>